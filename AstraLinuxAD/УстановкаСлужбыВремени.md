#### Установка службы NTP.
Добавим и запустить службу синхронизации времени ntp в автозапуск:
```bash
sudo systemctl status ntp
sudo systemctl start ntp
sudo systemctl enable ntp
```
Проверить работоспособность службы NTP в консоли с помощью команды: ``ntpq -p``

Настроить на локальный сервер можно здесь ``nano /etc/ntp.conf``
Добавить в соответствующей секции следующие строки:
```bash
server 127.127.1.0
fudge 127.127.1.0 stratum 10
restrict <network> mask <netmask> nomodify notrap

sudo systemctl enable ntp
sudo systemctl restart ntp
ntpq -p
remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
 LOCAL(0)        .LOCL.          10 l    7   64    1    0.000   +0.000   0.000
```
#### Установка службы chrony.

>[!Warning]
>Серверная служба chronyd (пакет chrony) Может обеспечивать работу ОС в режиме как сервера точного времени, так и клиента. Является штатной службой времени для использования с контроллерами домена FreeIPA.

```bash
sudo systemctl status chrony
если не установлена, установить можно так
sudo apt install chrony
sudo systemctl start chrony
sudo systemctl enable chrony     //добавим и запустить службу синхронизации времени chrony в автозапуск.
```
Добавим Российские NTP сервера и можно указать разрешённую сеть для клиентов.
Вводим ``nano /etc/chrony/chrony.conf`` и добавляем эти строки
```bash
server 0.ru.pool.ntp.org iburst
server 1.ru.pool.ntp.org iburst
server 2.ru.pool.ntp.org iburst
server 3.ru.pool.ntp.org iburst
allow 192.168.25.0/24
остальные закоментируем
```
![image](https://github.com/user-attachments/assets/ca157da9-9fab-4755-bef8-f3dcb9bee0de)

После настройки сервера нужно перезапустить службу: ``sudo systemctl restart chrony``

Проверим источники времени:``sudo chronyc -N sources``

Проверим порт. Сервер времени chrony, также как и другие NTP сервера слушает порт udp 123: ``sudo ss -ulpn | grep chronyd``

Можем посмотреть количество активных и не активных источников: ``sudo chronyc activity``

Сделаем перезагрузку и убедимся, что служба запускается автоматически.

>[Warning]
>Теперь нужно, на остальных серверах, прописать наш сервер Chrony в качестве источника синхронизации времени.
>Для этого укажем его адрес в ``/etc/systemd/timesyncd.conf`` на остальных серверах. А затем перезапустим службу синхронизации времени
```bash
[Time]
NTP=192.168.25.100
```

>[!Warning]
>Серверная служба chronyd (пакет chrony) Может обеспечивать работу ОС в режиме как сервера точного времени, так и клиента. Является штатной службой времени для использования с контроллерами домена FreeIPA.<br>
>Если при начальной настройке будущего контроллера домена желаете использовать службу синхронизации времени ntp, то делается это следующим образом (но!!! после установки контроллера домана, будет всё равно использоваться служба chrony).
